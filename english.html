
<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å­¦æ²»æ¨¡å—</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h2>ğŸ“š ç¼–è¾‘ï¼š<span id="subject-name">ç§‘ç›®åç§°</span></h2>
  <div class="editor">
    <label for="mode">è¯·é€‰æ‹©æ–‡æ¡£ç±»å‹ï¼š</label>
    <select id="mode" onchange="loadContent()">
      <option value="plan">è®¡åˆ’</option>
      <option value="report">æŠ¥å‘Š</option>
    </select>

    <label for="titleInput">æ ‡é¢˜ï¼š</label>
    <input type="text" id="titleInput" class="title-input" placeholder="è¯·è¾“å…¥æ ‡é¢˜" />

    <label for="refInput">æ–‡å·ï¼š</label>
    <input type="text" id="refInput" class="ref-input" placeholder="è¯·è¾“å…¥æ–‡å·" />

    <label for="bodyInput">æ­£æ–‡ï¼š</label>
    <textarea id="bodyInput" class="body-input" placeholder="è¯·è¾“å…¥æ­£æ–‡å†…å®¹"></textarea>

    <div class="btn-group">
      <button onclick="saveContent()">ğŸ’¾ ä¿å­˜</button>
      <button onclick="exportPDF()">ğŸ“„ å¯¼å‡º PDF</button>
      <button onclick="polishText()">ğŸª„ æ¶¦è‰²</button>
      <button onclick="proofreadText()">ğŸ” æ ¡å¯¹</button>
    </div>
  </div>

  <script>
    const subject = window.location.pathname.split("/").pop().split(".")[0];
    const subjectName = {
      yuwen: "è¯­æ–‡å…",
      math: "æ•°å­¦éƒ¨",
      english: "è‹±è¯­éƒ¨",
      history: "å†å²éƒ¨",
      geo: "åœ°ç†éƒ¨",
      politics: "æ”¿æ²»éƒ¨"
    }[subject] || "æœªçŸ¥ç§‘ç›®";

    document.getElementById("subject-name").innerText = subjectName;

    const titleInput = document.getElementById("titleInput");
    const refInput = document.getElementById("refInput");
    const bodyInput = document.getElementById("bodyInput");
    const mode = document.getElementById("mode");

    function saveContent() {
      localStorage.setItem(subject + "_title_" + mode.value, titleInput.value);
      localStorage.setItem(subject + "_ref_" + mode.value, refInput.value);
      localStorage.setItem(subject + "_body_" + mode.value, bodyInput.value);
      alert("å†…å®¹å·²ä¿å­˜ï¼");
    }

    function loadContent() {
      titleInput.value = localStorage.getItem(subject + "_title_" + mode.value) || "";
      refInput.value = localStorage.getItem(subject + "_ref_" + mode.value) || "";
      bodyInput.value = localStorage.getItem(subject + "_body_" + mode.value) || "";
    }

    function exportPDF() {
      const doc = new window.jspdf.jsPDF();
      doc.setFont("simsun", "normal");
      doc.setFontSize(18);
      doc.setTextColor(200, 0, 0);
      doc.text(titleInput.value, 20, 30);
      doc.setFontSize(12);
      doc.setTextColor(0, 0, 0);
      doc.text(refInput.value, 20, 40);
      const lines = doc.splitTextToSize(bodyInput.value, 170);
      doc.text(lines, 20, 55);
      doc.save(subject + "_" + mode.value + ".pdf");
    }

    function polishText() {
      bodyInput.value = bodyInput.value
        .replace(/å¾ˆå¤š/g, "è¯¸å¤š")
        .replace(/éå¸¸/g, "æä¸º")
        .replace(/å¤§å®¶/g, "å„ä½")
        .replace(/æˆ‘ä»¬è¦/g, "åº”å½“")
        .replace(/æœ‰æ—¶å€™/g, "æœ‰æ—¶");
    }

    function proofreadText() {
      let msg = "";
      if (bodyInput.value.includes("çš„çš„")) msg += "æ£€æµ‹åˆ°é‡å¤çš„â€œçš„â€ã€‚\n";
      if (bodyInput.value.includes("æ˜¯æ˜¯")) msg += "æ£€æµ‹åˆ°é‡å¤çš„â€œæ˜¯â€ã€‚\n";
      if (bodyInput.value.includes("æœ‰æœ‰")) msg += "æ£€æµ‹åˆ°é‡å¤çš„â€œæœ‰â€ã€‚\n";
      alert(msg || "æœªå‘ç°æ˜æ˜¾é”™åˆ«å­—ï¼");
    }

    loadContent(); // åˆå§‹åŒ–
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</body>
</html>
